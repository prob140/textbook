
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>6.4. The Hypergeometric, Revisited &#8212; Data 140 Textbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/Chapter_06/04_The_Hypergeometric_Revisited';</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.5. Odds Ratios" href="05_Odds_Ratios.html" />
    <link rel="prev" title="6.3. Multinomial Distribution" href="03_Multinomial_Distribution.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/sp22_ugarte_logo.png" class="logo__image only-light" alt="Data 140 Textbook - Home"/>
    <script>document.write(`<img src="../../_static/sp22_ugarte_logo.png" class="logo__image only-dark" alt="Data 140 Textbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    Data 140
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference external" href="http://prob140.org">Course Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../To_the_Student.html">To the  Student</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_01/00_Fundamentals.html">1. Fundamentals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_01/01_Outcome_Space_and_Events.html">1.1. Outcome Space and Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_01/02_Equally_Likely_Outcomes.html">1.2. Equally Likely Outcomes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_01/03_Collisions_in_Hashing.html">1.3. Collisions in Hashing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_01/04_Birthday_Problem.html">1.4. The Birthday Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_01/05_An_Exponential_Approximation.html">1.5. An Exponential Approximation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_01/06_Exercises.html">1.6. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_02/00_Calculating_Chances.html">2. Calculating Chances</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_02/01_Addition.html">2.1. Addition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_02/02_Examples.html">2.2. Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_02/03_Multiplication.html">2.3. Multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_02/04_More_Examples.html">2.4. More Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_02/05_Updating_Probabilities.html">2.5. Updating Probabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_02/06_Exercises.html">2.6. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_03/00_Random_Variables.html">3. Random Variables</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_03/01_Functions_on_an_Outcome_Space.html">3.1. Functions on an Outcome Space</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_03/02_Distributions.html">3.2. Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_03/03_Equality.html">3.3. Equality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_03/04_Exercises.html">3.4. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_04/00_Relations_Between_Variables.html">4. Relations Between Variables</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_04/01_Joint_Distributions.html">4.1. Joint Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_04/02_Examples.html">4.2. Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_04/03_Marginal_Distributions.html">4.3. Marginal Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_04/04_Conditional_Distributions.html">4.4. Conditional Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_04/05_Dependence_and_Independence.html">4.5. Dependence and Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_04/06_Exercises.html">4.6. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_05/00_Collections_of_Events.html">5. Collections of Events</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_05/01_Bounding_the_Chance_of_a_Union.html">5.1. Bounding the Chance of a Union</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_05/02_Inclusion_Exclusion.html">5.2. Inclusion-Exclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_05/03_The_Matching_Problem.html">5.3. The Matching Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_05/04_Sampling_Without_Replacement.html">5.4. Sampling Without Replacement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_05/05_Exercises.html">5.5. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="00_Random_Counts.html">6. Random Counts</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="01_Binomial_Distribution.html">6.1. The Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="02_Examples.html">6.2. Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="03_Multinomial_Distribution.html">6.3. Multinomial Distribution</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">6.4. The Hypergeometric, Revisited</a></li>
<li class="toctree-l2"><a class="reference internal" href="05_Odds_Ratios.html">6.5. Odds Ratios</a></li>
<li class="toctree-l2"><a class="reference internal" href="06_Law_of_Small_Numbers.html">6.6. The Law of Small Numbers</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_Exercises.html">6.7. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_07/00_Poissonization.html">7. Poissonization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_07/01_Poisson_Distribution.html">7.1. Poisson Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_07/02_Poissonizing_the_Binomial.html">7.2. Poissonizing the Binomial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_07/03_Poissonizing_the_Multinomial.html">7.3. Poissonizing the Multinomial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_07/04_Exercises.html">7.4. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_08/00_Expectation.html">8. Expectation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_08/01_Definition.html">8.1. Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_08/02_Applying_the_Definition.html">8.2. Applying the Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_08/03_Expectations_of_Functions.html">8.3. Expectations of Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_08/04_Additivity.html">8.4. Additivity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_08/05_Method_of_Indicators.html">8.5. Method of Indicators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_08/06_Exercises.html">8.6. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_09/00_Conditioning_Revisited.html">9. Conditioning, Revisited</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_09/01_Probability_by_Conditioning.html">9.1. Probability by Conditioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_09/02_Expectation_by_Conditioning.html">9.2. Expectation by Conditioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_09/03_Expected_Waiting_Times.html">9.3. Expected Waiting Times</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_09/04_Exercises.html">9.4. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_10/00_Markov_Chains.html">10. Markov Chains</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_10/01_Transitions.html">10.1. Transitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_10/02_Deconstructing_Chains.html">10.2. Deconstructing Chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_10/03_Long_Run_Behavior.html">10.3. Long Run Behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_10/04_Examples.html">10.4. Examples</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_11/00_Markov_Chain_Monte_Carlo.html">11. Markov Chain Monte Carlo</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_11/01_Balance_and_Detailed_Balance.html">11.1. Balance and Detailed Balance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_11/02_Code_Breaking.html">11.2. Code Breaking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_11/03_Metropolis_Algorithm.html">11.3. Metropolis Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_11/04_Exercises.html">11.4. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_12/00_Standard_Deviation.html">12. Standard Deviation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_12/01_Definition.html">12.1. Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_12/02_Prediction_and_Estimation.html">12.2. Prediction and Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_12/03_Bounds.html">12.3. Tail Bounds</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_12/04_Heavy_Tails.html">12.4. Heavy Tails</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_12/05_Exercises.html">12.5. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_13/00_Variance_Via_Covariance.html">13. Variance Via Covariance</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_13/01_Covariance.html">13.1. Covariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_13/02_Properties_of_Covariance.html">13.2. Properties of Covariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_13/03_Sums_of_Independent_Variables.html">13.3. Sums of Independent Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_13/04_Symmetry_and_Indicators.html">13.4. Symmetry and Indicators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_13/05_Finite_Population_Correction.html">13.5. Finite Population Correction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_13/06_Exercises.html">13.6. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_14/00_The_Central_Limit_Theorem.html">14. The Central Limit Theorem</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_14/01_Exact_Distribution_of_a_Sum.html">14.1. Exact Distribution of a Sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_14/02_PGFs_in_NumPy.html">14.2. PGFs in NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_14/03_Central_Limit_Theorem.html">14.3. Central Limit Theorem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_14/04_SciPy_and_Normal_Curves.html">14.4. SciPy and Normal Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_14/05_The_Sample_Mean.html">14.5. The Sample Mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_14/06_Confidence_Intervals.html">14.6. Confidence Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_14/07_Exercises.html">14.7. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_15/00_Continuous_Distributions.html">15. Continuous Distributions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_15/01_Density_and_CDF.html">15.1. Density and CDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_15/02_The_Meaning_of_Density.html">15.2. The Meaning of Density</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_15/03_Expectation.html">15.3. Expectation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_15/04_Exponential_Distribution.html">15.4. Exponential Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_15/05_Calculus_in_SymPy.html">15.5. Calculus in SymPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_15/06_Exercises.html">15.6. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_16/00_Transformations.html">16. Transformations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_16/01_Linear_Transformations.html">16.1. Linear Transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_16/02_Monotone_Functions.html">16.2. Monotone Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_16/03_Simulation_via_the_CDF.html">16.3. Simulation via the CDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_16/04_Two_to_One_Functions.html">16.4. Two-to-One Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_16/05_Exercises.html">16.5. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_17/00_Joint_Densities.html">17. Joint Densities</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_17/01_Probabilities_and_Expectations.html">17.1. Probabilities and Expectations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_17/02_Independence.html">17.2. Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_17/03_Marginal_and_Conditional_Densities.html">17.3. Marginal and Conditional Densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_17/04_Beta_Densities_with_Integer_Parameters.html">17.4. Beta Densities with Integer Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_17/05_Exercises.html">17.5. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_18/00_The_Normal_and_Gamma_Families.html">18. The Normal and Gamma Families</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_18/01_Standard_Normal_Basics.html">18.1. Standard Normal: The Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_18/02_Sums_of_Independent_Normal_Variables.html">18.2. Sums of Independent Normal Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_18/03_The_Gamma_Family.html">18.3. The Gamma Family</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_18/04_Chi_Squared_Distributions.html">18.4. Chi-Squared Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_18/05_Exercises.html">18.5. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_19/00_Distributions_of_Sums.html">19. Distributions of Sums</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_19/01_Convolution_Formula.html">19.1. The Convolution Formula</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_19/02_Moment_Generating_Functions.html">19.2. Moment Generating Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_19/03_MGFs_Normal_and_the_CLT.html">19.3. MGFs, the Normal, and the CLT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_19/04_Chernoff_Bound.html">19.4. Chernoff Bound</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_19/05_Exercises.html">19.5. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_20/00_Approaches_to_Estimation.html">20. Approaches to Estimation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_20/01_Maximum_Likelihood.html">20.1. Maximum Likelihood</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_20/02_Independence_Revisited.html">20.2. Independence, Revisited</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_20/03_Prior_and_Posterior.html">20.3. Prior and Posterior</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_20/04_Exercises.html">20.4. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_21/00_The_Beta_and_the_Binomial.html">21. The Beta and the Binomial</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_21/01_Updating_and_Prediction.html">21.1. Updating and Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_21/02_Beta_Binomial_Distribution.html">21.2. The Beta-Binomial Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_21/03_Long_Run_Proportion_of_Heads.html">21.3. Long Run Proportion of Heads</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_21/04_Exercises.html">21.4. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_22/00_Prediction.html">22. Prediction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_22/01_Conditional_Expectation_Projection.html">22.1. Conditional Expectation As a Projection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_22/02_Least_Squares_Predictor.html">22.2. Least Squares Predictor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_22/03_Variance_by_Conditioning.html">22.3. Variance by Conditioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_22/04_Examples.html">22.4. Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_22/05_Exercises.html">22.5. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_23/00_Multivariate_Normal_RVs.html">23. Jointly Normal Random Variables</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_23/01_Random_Vectors.html">23.1. Random Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_23/02_Multivariate_Normal_Vectors.html">23.2. Multivariate Normal Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_23/03_Multivariate_Normal_Density.html">23.3. Multivariate Normal Density</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_23/04_Independence.html">23.4. Independence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_23/05_Exercises.html">23.5. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_24/00_Simple_Linear_Regression.html">24. Simple Linear Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_24/01_Linear_Least_Squares.html">24.1. Least Squares Linear Predictor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_24/02_Bivariate_Normal_Distribution.html">24.2. Bivariate Normal Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_24/03_Regression_and_Bivariate_Normal.html">24.3. Regression and the Bivariate Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_24/04_Regression_Equation.html">24.4. The Regression Equation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_24/05_Exercises.html">24.5. Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../Chapter_25/00_Multiple_Regression.html">25. Multiple Regression</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_25/01_Bilinearity_in_Matrix_Notation.html">25.1. Bilinearity in Matrix Notation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_25/02_Best_Linear_Predictor.html">25.2. Best Linear Predictor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_25/03_Multivariate_Normal_Conditioning.html">25.3. Conditioning and the Multivariate Normal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Chapter_25/04_Multiple_Regression.html">25.4. Multiple Regression</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://prob140.datahub.berkeley.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/prob140/textbook&urlpath=tree/textbook/content/Chapter_06/04_The_Hypergeometric_Revisited.ipynb&branch=gh-pages" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/content/Chapter_06/04_The_Hypergeometric_Revisited.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>The Hypergeometric, Revisited</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-good-elements-in-a-srs">6.4.1. Number of Good Elements in a SRS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-aces-in-a-five-card-poker-hand">6.4.2. Example: Aces in a Five-Card Poker Hand</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#red-cards-in-a-bridge-hand">6.4.3. Red Cards in a Bridge Hand</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relation-with-the-binomial">6.4.4. Relation with the Binomial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fisher-s-exact-test">6.4.5. Fisher’s Exact Test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joint-marginal-and-conditional-distributions">6.4.6. Joint, Marginal, and Conditional Distributions</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="the-hypergeometric-revisited">
<h1><span class="section-number">6.4. </span>The Hypergeometric, Revisited<a class="headerlink" href="#the-hypergeometric-revisited" title="Link to this heading">#</a></h1>
<p>You have seen the hypergeometric probabilities earlier. In this section we will use them to define the distribution of a random count, and study the relation with the binomial distribution.</p>
<p>As a review of the hypergeometric setting, suppose you have a population of a fixed size <span class="math notranslate nohighlight">\(N\)</span>, and suppose you are interested in a particular group of those <span class="math notranslate nohighlight">\(N\)</span> individuals. Let’s call them “successes” or “good elements”. For example, you might be interested in:</p>
<ul class="simple">
<li><p>a population of voters, and among them the group who will vote for a particular candidate</p></li>
<li><p>a population of households, and among them the group that have annual incomes below $50,000</p></li>
<li><p>a deck of cards, and the suit of diamonds</p></li>
</ul>
<p>Let <span class="math notranslate nohighlight">\(N = G+B\)</span> where <span class="math notranslate nohighlight">\(G\)</span> is the number of good elements and <span class="math notranslate nohighlight">\(B\)</span> the remaining number of elements which we will unkindly describe as “bad”.</p>
<p>Now suppose you take a simple random sample (SRS) of <span class="math notranslate nohighlight">\(n\)</span> elements from the population.</p>
<section id="number-of-good-elements-in-a-srs">
<h2><span class="section-number">6.4.1. </span>Number of Good Elements in a SRS<a class="headerlink" href="#number-of-good-elements-in-a-srs" title="Link to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> be the number of good elements in the sample. What is the distribution of <span class="math notranslate nohighlight">\(X\)</span>?</p>
<p>The largest <span class="math notranslate nohighlight">\(X\)</span> can be is <span class="math notranslate nohighlight">\(\min(G, n)\)</span>. We’ll say the smallest <span class="math notranslate nohighlight">\(X\)</span> can be is 0, though if we are very careful we will see that in fact <span class="math notranslate nohighlight">\(X\)</span> can’t be any smaller than <span class="math notranslate nohighlight">\(\max(0, n-B)\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(g\)</span> be a possible value of <span class="math notranslate nohighlight">\(X\)</span>. Then, since all <span class="math notranslate nohighlight">\(\binom{N}{n}\)</span> samples are equally likely,</p>
<div class="math notranslate nohighlight">
\[
P(X = g) ~ = ~ \frac{\binom{G}{g} \binom{B}{b}}{\binom{N}{n}}, ~~~
g+b=n
\]</div>
<p>This is called the <em>hypergeometric distribution</em> with population size <span class="math notranslate nohighlight">\(N\)</span>, number of good elements or “successes” <span class="math notranslate nohighlight">\(G\)</span>, and sample size <span class="math notranslate nohighlight">\(n\)</span>. The name comes from the fact that the terms are the coefficients in a <a class="reference external" href="https://en.wikipedia.org/wiki/Hypergeometric_function#The_hypergeometric_series"><em>hypergeometric series</em></a>, which is a piece of mathematics that we won’t go into in this course.</p>
</section>
<section id="example-aces-in-a-five-card-poker-hand">
<h2><span class="section-number">6.4.2. </span>Example: Aces in a Five-Card Poker Hand<a class="headerlink" href="#example-aces-in-a-five-card-poker-hand" title="Link to this heading">#</a></h2>
<p>The number of aces <span class="math notranslate nohighlight">\(N_a\)</span> in a five-card poker hand has the hypergeometric distribution with population size 52, four good elements in the population, and a simple random sample size of 5.</p>
<div class="math notranslate nohighlight">
\[
P(N_a = k) = \frac{\binom{4}{k} \binom{48}{5-k}}{\binom{52}{5}}, ~~ k = 0, 1, 2, 3, 4
\]</div>
<p>The <code class="docutils literal notranslate"><span class="pre">stats.hypergeom.pmf</span></code> function allows us to calculate hypergeometric probabilities. The first argument is the set of possible values for which we want the probabilities. Then come the parameters, in the order population size, number of good elements, sample size.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">52</span> <span class="c1"># population size</span>
<span class="n">G</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># number of good elements in population</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># simple random sample size</span>
<span class="n">stats</span><span class="o">.</span><span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([  6.58841998e-01,   2.99473636e-01,   3.99298181e-02,
         1.73607905e-03,   1.84689260e-05])
</pre></div>
</div>
</div>
</div>
<p>Those are the chances of all the different possible numbers of aces in a poker hand. They are rather hard to read, so let’s try rounding them.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.659,  0.299,  0.04 ,  0.002,  0.   ])
</pre></div>
</div>
</div>
</div>
<p>The number of aces among 5 cards is overwhelmingly likely to be 0 or 1. The histogram of the distribution can be drawn using <code class="docutils literal notranslate"><span class="pre">Plot</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ace_probs</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">ace_dist</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">probabilities</span><span class="p">(</span><span class="n">ace_probs</span><span class="p">)</span>
<span class="n">Plot</span><span class="p">(</span><span class="n">ace_dist</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Number of Aces in a 5-Card Hand&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/fb38c0f0d028b18edefbab5ce6603f7fbe801935146992321d8e771259e6c1d9.png" src="../../_images/fb38c0f0d028b18edefbab5ce6603f7fbe801935146992321d8e771259e6c1d9.png" />
</div>
</div>
</section>
<section id="red-cards-in-a-bridge-hand">
<h2><span class="section-number">6.4.3. </span>Red Cards in a Bridge Hand<a class="headerlink" href="#red-cards-in-a-bridge-hand" title="Link to this heading">#</a></h2>
<p>Here is the distribution of the number of red cards in a bridge hand of 13 cards:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">52</span>
<span class="n">G</span> <span class="o">=</span> <span class="mi">26</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">bridge_probs</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">bridge_dist</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">probabilities</span><span class="p">(</span><span class="n">bridge_probs</span><span class="p">)</span>

<span class="n">Plot</span><span class="p">(</span><span class="n">bridge_dist</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Number of Red Cards in a 13-Card Hand&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b42360debc12f16ce81f8395198eccd80b3460900e5b1e91a90ca213f0fb6a7e.png" src="../../_images/b42360debc12f16ce81f8395198eccd80b3460900e5b1e91a90ca213f0fb6a7e.png" />
</div>
</div>
<p>This one looks rather binomial. And indeed, there is a close relation between the binomial and the hypergeometric distributions.</p>
</section>
<section id="relation-with-the-binomial">
<h2><span class="section-number">6.4.4. </span>Relation with the Binomial<a class="headerlink" href="#relation-with-the-binomial" title="Link to this heading">#</a></h2>
<p>Suppose you have a population of <span class="math notranslate nohighlight">\(N = G+B\)</span> elements as above, and suppose you sample <span class="math notranslate nohighlight">\(n\)</span> times <em>with</em> replacement. Then the number of good elements in the sample has the binomial distribution with parameters <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(G/N\)</span>.</p>
<p>If you sample <em>without</em> replacement, then the distribution of the number of good elements is hypergeometric <span class="math notranslate nohighlight">\((N, G, n)\)</span>.</p>
<p>The only difference between the two settings is the randomization: sampling with or without replacement.</p>
<p>If the population size <span class="math notranslate nohighlight">\(N\)</span> is large relative to the sample size <span class="math notranslate nohighlight">\(n\)</span>, then it doesn’t make much difference whether you are sampling with or without replacement. If you only take out a very small proportion of the population as you sample, you make no noticeable difference to the proportions in the population.</p>
<p>To see whether this intuition can be confirmed by calculation, let’s visualize some hypergeometric distributions and the corresponding binomial approximations. You can change the parameters in the code below. Just make sure that <span class="math notranslate nohighlight">\(n\)</span> is small relative to <span class="math notranslate nohighlight">\(N\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">G</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">hyp_probs</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">bin_probs</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">G</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">hyp_dist</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">probabilities</span><span class="p">(</span><span class="n">hyp_probs</span><span class="p">)</span>
<span class="n">bin_dist</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">probabilities</span><span class="p">(</span><span class="n">bin_probs</span><span class="p">)</span>
<span class="n">Plots</span><span class="p">(</span><span class="s1">&#39;Hypergeometric (100, 30, 10)&#39;</span><span class="p">,</span> <span class="n">hyp_dist</span><span class="p">,</span> <span class="s1">&#39;Binomial (10, 0.3)&#39;</span><span class="p">,</span> <span class="n">bin_dist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/8ad63ad38c3b6bc395a53c735c4963d6d5e4d4ef560703642b98c6b5e66850e8.png" src="../../_images/8ad63ad38c3b6bc395a53c735c4963d6d5e4d4ef560703642b98c6b5e66850e8.png" />
</div>
</div>
<p>They are pretty close, though you can see that the hypergeometric distribution is a bit taller and narrower. In a later chapter we will quantify this difference in spread.</p>
</section>
<section id="fisher-s-exact-test">
<h2><span class="section-number">6.4.5. </span>Fisher’s Exact Test<a class="headerlink" href="#fisher-s-exact-test" title="Link to this heading">#</a></h2>
<p>Recall a <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/11376175">randomized controlled experiment</a> that was analyzed in Data 8. The treatment was the botulinum toxin A, a very potent toxin, used as medication for patients who had chronic back pain.</p>
<p>A total of 31 patients participated in the study. Of these, 15 were randomly assigned to the treatment group and the remaining 16 to the control group. Eight weeks after treatment, 11 of the 15 in the treatment group had pain relief compared to 2 out of 16 in the control group.</p>
<p>In other words, of the 13 patients who had pain relief, 11 were in the treatment group and 2 in the control group. Is this evidence in favor of the treatment?</p>
<p>The null hypothesis says that the treatment does nothing; any difference between the two groups is due to the random assignment of patients to treatment and control.</p>
<p>The alternative hypothesis says that the treatment was beneficial.</p>
<p>Under the null hypothesis, the treatment did nothing different from the control, so among the 31 patients in the study, <em>13 would have had pain relief anyway</em>, regardless of the assignment to groups.</p>
<p>To see which of the hypotheses is better supported by the data, we can find a P-value. This is the chance, under the null hypothesis, of getting data like the data that were observed or even more in the direction of the alternative. That is, the P-value is the chance of getting 11 or more of the “pain relief” patients in the treatment group, just by chance.</p>
<p>To find the chance that 11 or more of the “pain relief” group would have ended up in the treatment group, we just need a hypergeometric probability:</p>
<ul class="simple">
<li><p>N = 31, the population size</p></li>
<li><p>G = 13, the total number of “pain relief” patients</p></li>
<li><p>n = 15, the size of the treatment group</p></li>
<li><p>g = 11 or more</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0008299755046076283
</pre></div>
</div>
</div>
</div>
<p>That’s a very small P-value, which implies that the data support the alternative hypothesis more than they support the null. The treatment helped. This is consistent with the conclusion of the researchers and also with our own analysis in Data 8 – but all three analyses are different.</p>
<p>In Data 8 we simulated the difference between the two group proportions under the null hypothesis, by pooling the two groups and randomly permuting the pooled sample. Our conclusion was based on an empirical, approximate P-value.</p>
<p>The calculation here does not require simulation and produces an exact P-value.</p>
<p>This method is called Fisher’s exact test. That’s the same Sir Ronald Fisher who formalized tests of hypotheses, suggested cutoffs for P-values, and so on. The method can be used for any sample size and any randomized controlled experiment with a binary response.</p>
</section>
<section id="joint-marginal-and-conditional-distributions">
<h2><span class="section-number">6.4.6. </span>Joint, Marginal, and Conditional Distributions<a class="headerlink" href="#joint-marginal-and-conditional-distributions" title="Link to this heading">#</a></h2>
<p>The calculations above extend easily to samples that can come out in more than two categories. Consider a five-card poker hand dealt from a well-shuffled deck. Let <span class="math notranslate nohighlight">\(H\)</span> be the number of hearts and <span class="math notranslate nohighlight">\(S\)</span> the number of spades in the hand. Let us find the joint distribution of <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span>.</p>
<p>The hand can have cards other than hearts and spades, of course. Let <span class="math notranslate nohighlight">\(X\)</span> be the number of those cards, which must be diamonds or clubs. Then</p>
<div class="math notranslate nohighlight">
\[
P(H = h, S = s) ~ = ~ P(H = h, S = s, X = 5 - (h+s)) ~ = ~ 
\frac{\binom{13}{h}\binom{13}{s}\binom{26}{5-h-s}}{\binom{52}{5}}, ~~ h, s \ge 0, ~ h+s \le 5
\]</div>
<p>The SciPy module <code class="docutils literal notranslate"><span class="pre">special</span></code> allows you to calculate binomial coefficients, so let’s import it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">special</span>
</pre></div>
</div>
</div>
</div>
<p>The expression <code class="docutils literal notranslate"><span class="pre">special.comb(n,</span> <span class="pre">k)</span></code> evaluates to <span class="math notranslate nohighlight">\(\binom{n}{k}\)</span>. This allows us to calculate the joint distribution of <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(S\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">joint_prob</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">h</span><span class="o">+</span><span class="n">s</span> <span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">h</span><span class="o">+</span><span class="n">s</span> <span class="o">&lt;=</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="n">special</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">h</span> <span class="o">-</span><span class="n">s</span><span class="p">)</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="n">special</span><span class="o">.</span><span class="n">comb</span><span class="p">(</span><span class="mi">52</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    
<span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">joint_dist</span> <span class="o">=</span> <span class="n">Table</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">probability_function</span><span class="p">(</span><span class="n">joint_prob</span><span class="p">)</span>
<span class="n">joint_dist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>H=0</th>
      <th>H=1</th>
      <th>H=2</th>
      <th>H=3</th>
      <th>H=4</th>
      <th>H=5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>S=5</th>
      <td>0.000495</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>S=4</th>
      <td>0.007153</td>
      <td>0.003576</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>S=3</th>
      <td>0.035764</td>
      <td>0.037195</td>
      <td>0.008583</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>S=2</th>
      <td>0.078031</td>
      <td>0.126801</td>
      <td>0.060864</td>
      <td>0.008583</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>S=1</th>
      <td>0.074780</td>
      <td>0.169068</td>
      <td>0.126801</td>
      <td>0.037195</td>
      <td>0.003576</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>S=0</th>
      <td>0.025310</td>
      <td>0.074780</td>
      <td>0.078031</td>
      <td>0.035764</td>
      <td>0.007153</td>
      <td>0.000495</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The distribution of <span class="math notranslate nohighlight">\(H\)</span> can be obtained by summing along the columns, or by using the <code class="docutils literal notranslate"><span class="pre">marginal</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joint_dist</span><span class="o">.</span><span class="n">marginal</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>H=0</th>
      <th>H=1</th>
      <th>H=2</th>
      <th>H=3</th>
      <th>H=4</th>
      <th>H=5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>S=5</th>
      <td>0.000495</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>S=4</th>
      <td>0.007153</td>
      <td>0.003576</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>S=3</th>
      <td>0.035764</td>
      <td>0.037195</td>
      <td>0.008583</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>S=2</th>
      <td>0.078031</td>
      <td>0.126801</td>
      <td>0.060864</td>
      <td>0.008583</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>S=1</th>
      <td>0.074780</td>
      <td>0.169068</td>
      <td>0.126801</td>
      <td>0.037195</td>
      <td>0.003576</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>S=0</th>
      <td>0.025310</td>
      <td>0.074780</td>
      <td>0.078031</td>
      <td>0.035764</td>
      <td>0.007153</td>
      <td>0.000495</td>
    </tr>
    <tr>
      <th>Sum: Marginal of H</th>
      <td>0.221534</td>
      <td>0.411420</td>
      <td>0.274280</td>
      <td>0.081543</td>
      <td>0.010729</td>
      <td>0.000495</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>But <span class="math notranslate nohighlight">\(H\)</span> is the number of hearts in a five-card hand, so we already know that <span class="math notranslate nohighlight">\(H\)</span> has the hypergeometric <span class="math notranslate nohighlight">\((52, 13, 5)\)</span> distribution. Let’s confirm that this is the same as the marginal distribution above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.22153361,  0.41141957,  0.27427971,  0.08154262,  0.01072929,
        0.0004952 ])
</pre></div>
</div>
</div>
</div>
<p>If you know how many spades are in the hand, then what is the conditional distribution of <span class="math notranslate nohighlight">\(H\)</span>?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">joint_dist</span><span class="o">.</span><span class="n">conditional_dist</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>H=0</th>
      <th>H=1</th>
      <th>H=2</th>
      <th>H=3</th>
      <th>H=4</th>
      <th>H=5</th>
      <th>Sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Dist. of H | S=5</th>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dist. of H | S=4</th>
      <td>0.666667</td>
      <td>0.333333</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dist. of H | S=3</th>
      <td>0.438596</td>
      <td>0.456140</td>
      <td>0.105263</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dist. of H | S=2</th>
      <td>0.284495</td>
      <td>0.462304</td>
      <td>0.221906</td>
      <td>0.031294</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dist. of H | S=1</th>
      <td>0.181761</td>
      <td>0.410937</td>
      <td>0.308203</td>
      <td>0.090406</td>
      <td>0.008693</td>
      <td>0.000000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Dist. of H | S=0</th>
      <td>0.114250</td>
      <td>0.337556</td>
      <td>0.352232</td>
      <td>0.161440</td>
      <td>0.032288</td>
      <td>0.002235</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Marginal of H</th>
      <td>0.221534</td>
      <td>0.411420</td>
      <td>0.274280</td>
      <td>0.081543</td>
      <td>0.010729</td>
      <td>0.000495</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s see if we recognize these numbers. Remember that the <span class="math notranslate nohighlight">\((h, s)\)</span> cell of the table contains <span class="math notranslate nohighlight">\(P(H = h \mid S =s )\)</span>.</p>
<p>For an extreme case, look at the top row. Given that there are five spades in the hand, there can’t be any hearts. That is why the table says <span class="math notranslate nohighlight">\(P(H = 0 \mid S = 5) = 1\)</span>.</p>
<p>Now suppose we are given that <span class="math notranslate nohighlight">\(S = 1\)</span>. Then <span class="math notranslate nohighlight">\(H\)</span> can have values 0 through 4, and for any integer <span class="math notranslate nohighlight">\(h\)</span> in this range we have</p>
<div class="math notranslate nohighlight">
\[
P(H = h \mid S = 1) ~ = ~ \frac{P(H = h, S = 1)}{P(S = 1)} ~ = ~ 
\frac{\binom{13}{h}\binom{13}{1}\binom{26}{5 - h - 1}}{\binom{13}{1}\binom{39}{4}}
\]</div>
<p>by canceling factors of <span class="math notranslate nohighlight">\(1/\binom{52}{5}\)</span> in the numerator and denominator. After canceling <span class="math notranslate nohighlight">\(\binom{13}{1}\)</span> as well, we have</p>
<div class="math notranslate nohighlight">
\[
P(H = h \mid S = 1) ~ = ~ \frac{\binom{13}{h}\binom{26}{4 - h}}{\binom{39}{4}}, ~~ 0 \le h \le 4
\]</div>
<p>This is the hypergeometric <span class="math notranslate nohighlight">\((39, 13, 4)\)</span> distribution: given that there is one spade in the hand, the other four cards are like a simple random sample drawn from the 39 hearts, diamonds, and clubs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">hypergeom</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.18176071,  0.41093725,  0.30820294,  0.0904062 ,  0.0086929 ])
</pre></div>
</div>
</div>
</div>
<p>These are the probabilities in the row corresponding to the given condition <span class="math notranslate nohighlight">\(S=1\)</span> in the table of conditional distributions above.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/Chapter_06"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="03_Multinomial_Distribution.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6.3. </span>Multinomial Distribution</p>
      </div>
    </a>
    <a class="right-next"
       href="05_Odds_Ratios.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.5. </span>Odds Ratios</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#number-of-good-elements-in-a-srs">6.4.1. Number of Good Elements in a SRS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-aces-in-a-five-card-poker-hand">6.4.2. Example: Aces in a Five-Card Poker Hand</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#red-cards-in-a-bridge-hand">6.4.3. Red Cards in a Bridge Hand</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relation-with-the-binomial">6.4.4. Relation with the Binomial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fisher-s-exact-test">6.4.5. Fisher’s Exact Test</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#joint-marginal-and-conditional-distributions">6.4.6. Joint, Marginal, and Conditional Distributions</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ani Adhikari
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>